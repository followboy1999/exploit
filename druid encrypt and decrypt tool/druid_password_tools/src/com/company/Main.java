package com.company;
import com.alibaba.druid.filter.config.ConfigTools;
import java.security.NoSuchAlgorithmException;
import java.security.NoSuchProviderException;

public class Main {

    public static void main(String[] args) throws Exception {
	// write your code here
        System.out.println("[*]druid password encrypt and decrypt tools");
        if (args.length < 2) {
            System.out.println("[*]usage: java -jar druid_password_tools.jar [-e or -d] password [publickey]");
            System.exit(1);
        }
        String opt = args[0];
        String password = args[1];

        if (opt.equals("-e")) {
            System.out.println("[*]encrypt pasword");
            String[] arr = ConfigTools.genKeyPair(512);
            System.out.println("[privateKey]:" + arr[0]);
            System.out.println("[publicKey]:" + arr[1]);
            String encryptpassword = ConfigTools.encrypt(arr[0], password);
            System.out.println("[encrypt password]:" + ConfigTools.encrypt(arr[0], password));
            System.out.println("[plaint password]:" + ConfigTools.decrypt(arr[1], encryptpassword));
        }else if (opt.equals("-d")) {
            String publicKey = args[2];
            System.out.println("[encrypt password]:" + password);
            if (password.length() != 88){
                System.out.println("[*]wrong pass length");
                System.exit(1);
            }
            //ConfigTools.decrypt(password);
            try {
                //ConfigTools.decrypt(publicKey,password);
                System.out.println("[decrypt password]:" + ConfigTools.decrypt(publicKey,password));
            } catch (Exception e) {
                //System.out.println("[*]may be need change publicKey");
                e.printStackTrace();

            }

        }else {
            System.out.println("[+]need -d or -e");
        }
    }
}
